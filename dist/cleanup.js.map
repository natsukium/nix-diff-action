{"version":3,"file":"cleanup.js","names":[],"sources":["../src/cleanup.ts"],"sourcesContent":["import * as core from \"@actions/core\";\nimport { Effect } from \"effect\";\nimport { removeWorktree } from \"./services/git.js\";\n\nconst cleanup = Effect.gen(function* () {\n  const worktreePath = yield* Effect.sync(() => core.getState(\"worktreePath\"));\n\n  if (!worktreePath) {\n    yield* Effect.logInfo(\"No worktree path saved, skipping cleanup\");\n    return;\n  }\n\n  yield* removeWorktree(worktreePath);\n  yield* Effect.logInfo(`Cleaned up worktree at ${worktreePath}`);\n});\n\n// Export for testability - allows mocking and unit testing\nexport const run = (): Promise<void> =>\n  cleanup.pipe(\n    Effect.catchAll((error) => Effect.sync(() => core.warning(`Cleanup failed: ${error}`))),\n    Effect.runPromise,\n  );\n\n// Entry point: only execute when run directly as GitHub Actions post script\nrun();\n"],"mappings":";;AAIA,IAAM,UAAU,IAAW,aAAa;CACtC,MAAM,eAAe,OAAO,WAAA,YAAuB,SAAS,eAAe,CAAC;AAE5E,KAAI,CAAC,cAAc;AACjB,SAAO,QAAe,2CAA2C;AACjE;;AAGF,QAAO,eAAe,aAAa;AACnC,QAAO,QAAe,0BAA0B,eAAe;EAC/D;AAGF,MAAa,YACX,QAAQ,KACN,UAAiB,UAAU,WAAA,YAAuB,QAAQ,mBAAmB,QAAQ,CAAC,CAAC,EACvF,WACD;AAGH,KAAK"}